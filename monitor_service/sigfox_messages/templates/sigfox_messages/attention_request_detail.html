{% extends 'base_templates/base.html' %}

{% block content %}
  {% if not_allowed %}
    <div class="alert alert-danger">
      <strong>You're not allowed to see this information.</strong>
    </div>
  {% else %}
    {% if att_req %}
      <div class="alert alert-info">
        <h5>Patient <a href="{% url 'patient_detail' att_req.patient %}">{{ att_req.patient.name }}
          {{ att_req.patient.surname }}</a> requested attention from our medical team. Request information:</h5>
      </div>
      <ul class="list-group mt-3">
        <li class="list-group-item"><strong>Request date/time:</strong> {{ att_req.request_timestamp }}</li>
        <li class="list-group-item"><strong>Request type ("Normal"/"Urgent"):</strong> 
        {{ att_req.request_priority }}</li>
        <li class="list-group-item"><strong>Assigned doctor:</strong>
        <a href="{% url 'doctor_detail' att_req.doctor.id %}">{{ att_req.doctor }}</a></li>
        <li class="list-group-item"><strong>Request state ("Attended"/"Unattended"):</strong>
        {{ att_req.status }}</li>
      </ul>

      {% if associated_emergency %}
        <div class="alert alert-warning mt-4">
          <strong>This request was automatically generated by the following emergency: 
            <a href="{% url 'emergency_detail' att_req.emergency.id %}">{{ att_req.emergency.spawn_timestamp }}</a>
          </strong>
        </div>
      {% else %}
        <div class="alert alert-warning mt-3">
          <strong>*This request was <strong>manually registered*</strong></strong>
        </div>
      {% endif %}

      {% if not_attended %}
        <div class="mt-4">
          <strong>When you regard the request as attended, click on the following button to update its 
          state on the system:</strong> 
          <a href="{% url 'att_req_detail' att_req.id %}?emergency_attended=true" class="btn btn-primary">
          Set request as attended</a>
        </div>
      {% else %}
        <div class="alert alert-success mt-3">
          <strong>This request has already been attended by our medical team.</strong>
        </div>
      {% endif %}

    {% else %}
      <div class="alert alert-danger mt-3">
        <strong>Attention request data not available.</strong>
      </div>
    {% endif %}
  {% endif %}
{% endblock %}
